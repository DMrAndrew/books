<div class="book-card-full__info book-card-full-info">
    <div class="book-card-full-info__button-wrapper">
        {% if user %}
        {% partial '@card-header-buttons' %}
        {% endif %}
    </div>
    <div class="book-card-full-info__rating">
        <div class="book-card__raiting">
            <svg>
                <use xlink:href="{{'assets/icon-sprite/svg-sprite.svg#star-filled-16' | theme}}"></use>
            </svg>
            <span>{{book.stats.rate?:0}}</span>
        </div>
        <div class="tags-list">
            {% partial 'controls/genres-link-list' genres=book.genres linkClass='book-card-full-info__link _desktop' %}
        </div>

        {% if genres[0] %}
        <button class="book-card-full-info__button-raiting" data-modal="open_category_rating">
            <span>Рейтинг в категориях</span>
            <svg class="square-16">
                <use xlink:href="{{'assets/icon-sprite/svg-sprite.svg#chevron-down-16' | theme}}"></use>
            </svg>
        </button>
        <div class="ui-modal overlay" data-modal="category_rating">
            <div class="ui-modal-container _mobile-bottom">
                <div class="ui-modal-content">
                    <div class="ui-modal-header">
                        <div class="square-16 "></div>
                        <div class="ui-text-head--2 ui-text--bold">Рейтинг в категориях</div>
                        <svg class="square-24" data-modal="close">
                            <use xlink:href="{{'assets/icon-sprite/svg-sprite.svg#close-stroked-16' | theme}}"></use>
                        </svg>
                    </div>
                    <div class="ui-modal__body tags-list">
                        {% partial 'controls/genres-link-list' genres=book.genres linkClass='book-card-full-info__link'
                        %}
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
    {% partial '@book-card-footer' class='book-card-full-info__footer' %}
    <script>
        openModal('[data-modal="category_rating"]', '[data-modal="open_category_rating"]');
    </script>
    <div class="book-card-repost" style="padding-top:12px;border: none">
        <span>Поделиться: {{this.page.url}} </span>
        <!--        <svg class="square-32" style="color: #0077FF;">-->
        <!--            <use xlink:href="{{'assets/icon-sprite/svg-sprite.svg#logo-vk-28' | theme}}"></use>-->
        <!--        </svg>-->
        <script type="text/javascript">
            document.write(VK.Share.button(document.URL));
        </script>
        <!--        <svg class="square-32" style="color: #54A9E7;">-->
        <!--            <use xlink:href="{{'assets/icon-sprite/svg-sprite.svg#logo-telegram-28' | theme}}"></use>-->
        <!--        </svg>-->

        <div id="tg-widget"></div>
        <!--        <script async src="https://telegram.org/js/telegram-widget.js?22"-->
        <!--                data-telegram-share-url="{{this.page.url}}"-->
        <!--                data-text="notext"-->
        <!--        ></script>-->

        <script>
            !function (d) {
                var js = d.createElement("script");
                js.src = "https://telegram.org/js/telegram-widget.js?22";
                js.async = true
                js.dataset.telegramShareUrl = document.URL
                js.dataset.text = 'notext'

                d.getElementById('tg-widget').appendChild(js);
            }(document);
        </script>

        <!--        <svg id="ok_shareWidget" class="square-32 cursor-pointer">-->
        <!--            <use xlink:href="{{'assets/icon-sprite/svg-sprite.svg#social-ok-filled-32' | theme}}"></use>-->
        <!--        </svg>-->
        <div id="ok_shareWidget"></div>

        <script>
            !function (d, id, did, st, title, description, image) {
                function init() {
                    OK.CONNECT.insertShareWidget(id, did, st, title, description, image);
                }

                if (!window.OK || !OK.CONNECT || !OK.CONNECT.insertShareWidget) {
                    var js = d.createElement("script");
                    js.src = "https://connect.ok.ru/connect.js";
                    js.onload = js.onreadystatechange = function () {
                        if (!this.readyState || this.readyState == "loaded" || this.readyState == "complete") {
                            if (!this.executed) {
                                this.executed = true;
                                setTimeout(init, 0);
                            }
                        }
                    };
                    d.documentElement.appendChild(js);
                } else {
                    init();
                }
            }(document, "ok_shareWidget", document.URL, '{"sz":30,"st":"oval","nc":1,"nt":1,"bgclr":"ED8207","txclr":"FFFFFF"}', "", "", "");
        </script>
    </div>
</div>
