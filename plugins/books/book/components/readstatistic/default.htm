<!-- Статистика с таблицей "Все произведения" -->
<div class="read-statistic wrapper" style="margin-bottom: 32px;">
    <div class="read-statistic__select ui-select _indent-large">
        <div class="ui-select-container">
            <div class="ui-select-item _size-32">
                <select  class="book-select" name="book_id" style="display: none">
                    <option
                        {{ not current_book ? 'selected' : ''  }}
                    value="">Все произведения</option>
                    {% for book in books %}
                    <option  value="{{book.id}}"
                             {{ current_book.id == book.id ? 'selected' : ''  }}
                    >{{book.title}}</option>
                    {% endfor %}

                </select>
                <svg class="ui-select-item-icon">
                    <use xlink:href="{{'assets/icon-sprite/svg-sprite.svg#chevron-down-16' | theme}}"></use>
                </svg>
            </div>
        </div>
    </div>

    <div class="read-statistic__select _max-width ui-select">
        <div class="ui-select-header">
            <label class="ui-select-label">Период</label>
        </div>
        <div class="ui-select-container">
            <div class="ui-select-item _size-32">
                <div class="ui-select-item-option">20.01.2022–21.04.2022</div>
                <svg class="ui-select-item-icon">
                    <use xlink:href="./assets/icon-sprite/svg-sprite.svg#chevron-down-16"></use>
                </svg>
            </div>
        </div>
    </div>

    <div class="table">
        <div class="table__head">
            <div class="table__col _half">Произведение</div>
            {% for date in dates %}
            <div class="table__col">{{date}}</div>
            {% endfor %}

        </div>

        <div class="table__list">
            {% for book in statistic %}
            <div class="table__row">
                <div class="table__col _half" data-title="Произведение">{{book.title}}</div>
                {% for stat in book.read_statistics %}
                <div class="table__col" data-title="{{stat.date}}">{{stat.count|default(' ')}}</div>
                {% endfor %}
            </div>
            {% endfor %}


            <div class="table__row">
                <div class="table__col _half _bold">Итого</div>
                {% for book in statistic %}
                <div class="table__col _bold">{{collect(book.read_statistics).pluck('count').sum}}</div>
                {% endfor %}
            </div>
        </div>
    </div>

</div>


<!-- Статистика с таблицей "График" -->
<div class="read-statistic wrapper">
    <div class="read-statistic__select ui-select _indent-large">
        <div class="ui-select-container">
            <div class="ui-select-item _size-32">
                <div class="ui-select-item-option">Кукла</div>
                <svg class="ui-select-item-icon">
                    <use xlink:href="./assets/icon-sprite/svg-sprite.svg#chevron-down-16"></use>
                </svg>
            </div>
        </div>
    </div>

    <div class="read-statistic__control">
        <a href="#" class="ui-link _violet">Статистика по частям</a>
    </div>

    <div class="read-statistic__description">
        <p class="ui-text-body--2">Внимание! Если вы удалили часть произведения и добавили ее снова, то статистика прочтений этой части начнет считаться заново.</p>
    </div>

    <div class="read-statistic__select _max-width ui-select">
        <div class="ui-select-header">
            <label class="ui-select-label">Период</label>
        </div>
        <div class="ui-select-container">
            <div class="ui-select-item _size-32">
                <div class="ui-select-item-option">20.01.2022–21.04.2022</div>
                <svg class="ui-select-item-icon">
                    <use xlink:href="./assets/icon-sprite/svg-sprite.svg#chevron-down-16"></use>
                </svg>
            </div>
        </div>
    </div>

    <div class="read-statistic__title ui-text-head--3 ui-text--bold">Всего: 11727</div>

    <div class="read-statistic__chart">
        <canvas id="chart"></canvas>
    </div>

    <div class="table">
        <div class="table__head">
            <div class="table__col _wide">Дата</div>
            <div class="table__col">Кол-во прочтений</div>
        </div>

        <div class="table__list">
            <div class="table__row">
                <div class="table__col _wide" data-title="Дата">22.08.10</div>
                <div class="table__col" data-title="Кол-во прочтений">79</div>
            </div>
            <div class="table__row">
                <div class="table__col _wide" data-title="Дата">22.08.10</div>
                <div class="table__col" data-title="Кол-во прочтений">79</div>
            </div>
            <div class="table__row">
                <div class="table__col _wide" data-title="Дата">22.08.10</div>
                <div class="table__col" data-title="Кол-во прочтений">79</div>
            </div>
            <div class="table__row">
                <div class="table__col _wide" data-title="Дата">22.08.10</div>
                <div class="table__col" data-title="Кол-во прочтений">79</div>
            </div>
            <div class="table__row">
                <div class="table__col _wide" data-title="Дата">22.08.10</div>
                <div class="table__col" data-title="Кол-во прочтений">79</div>
            </div>
            <div class="table__row">
                <div class="table__col _wide" data-title="Дата">22.08.10</div>
                <div class="table__col" data-title="Кол-во прочтений">79</div>
            </div>
            <div class="table__row">
                <div class="table__col _wide _right"></div>
                <div class="table__col _bold">Итого: 474</div>
            </div>
        </div>

    </div>
</div>
<script>
    initGraph('chart',[
        '01.09.20', '03.09.20', '05.09.20',
        '07.09.20', '09.09.20', '11.09.20',
        '13.09.20', '15.09.20', '17.09.20',
        '19.09.20', '21.09.20', '23.09.20',
        '25.09.20', '27.09.20', '29.09.20',
        '30.09.20',
    ],[
        450, 520, 560,
        530, 280, 260,
        390, 520, 510,
        525, 440, 380,
        385, 330, 325,
        360
    ])
</script>
