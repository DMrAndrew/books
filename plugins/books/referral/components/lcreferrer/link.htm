<div class="referral__link">
    <form data-request="onGenerateReferralLink"
          data-request-validate="true"
          data-request-flash="true">

        <div class="referral__input ui-input">
            <label class="ui-input-label">Целевая страница</label>
            <input class="ui-input-item _size-32" id="target_link" name="target_link" type="text" value="{{ referrer.target_link }}" required="">
            <div class="commerce__text ui-text-body--3">(страница, на которую попадет пользователь при переходе по реферальной ссылке)</div>
        </div>

        <button type="submit" class="ui-button ui-button-size--32 ui-button-view--2">
            <span class="ui-text--medium">Сгенерировать реферальную ссылку</span>
        </button>
    </form>
</div>
<div class="referral__copy">
    <div class="referral__input ui-input">
         <label class="ui-input-label">Реферальная ссылка</label>
        <input id="referralLink" class="ui-input-item _size-32" type="text" value="{{ referrer_link }}" disabled readonly>
    </div>

    <button id="copyReferralLink" class="ui-button ui-button-size--32 ui-button-view--2">
        <span class="ui-text--medium">Скопировать</span>
    </button>

    <span id="messageCopied" class="personal-area__wrap _indent-medium _color-gray ui-text-body--3 hidden" style="display: none">
        Ссылка скопирована в буфер обмена
    </span>
</div>
<script>
    $('#copyReferralLink').click(function(){
        copyTextToClipboard( $('#referralLink').val() );
        toggleMessageCopied();
    });

    function copyTextToClipboard(text) {
        navigator.clipboard.writeText(text).then(function() {
            console.log('Async: Copying to clipboard was successful!');
        }, function(err) {
            console.error('Async: Could not copy text: ', err);
        });
    }

    function toggleMessageCopied() {
        let message = $('#messageCopied');
        message.css("display", "inline");
        setTimeout(function(){
            message.css("display", "none");
        }, 2000);
    }
</script>
